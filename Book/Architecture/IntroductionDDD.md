# ドメイン駆動設計入門

筋道立てて説明しようとしていることを読者に伝えつつ解説している。

## ドメインの概念

基本的なドメインの概念を表現する手段は３つ

1. 値オブジェクト
2. エンティティ
3. ドメインサービス

ドメインの概念を用いて組み立てられるもの

1. ユースケース

## ドメインモデルとは

> ドメインは「領域」の意味を持った言葉

## 値オブジェクト

システム固有の値を表現することを目的としたオブジェクト(クラス)のこと。

オブジェクト指向的な側面もある。
例としてFullNameオブジェクトにFirstNameとLastNameのプロパティがあるようなものを挙げている。

文字列リテラルのような「値」は不変であり「値オブジェクト」と「オブジェクト」との違いを説明される。

値は代入（交換）によってのみ変更を表現可能である。
値は等価性によって比較される。

値オブジェクトは値であるため、`1 == 1`と同じように`a == b`というように比較可能であるべき。
`a.value == b.value`ではいけない。
値オブジェクトにプロパティが追加されても、この比較方法なら修正不要となる。


値オブジェクトにすべきかどうかの一つ判断基準は
1. そこにルールが存在しているか
2. それ単体で取り扱いたいか

## エンティティ

固有の同一性（identity）で識別するオブジェクト（クラス）のこと

エンティティはライフサイクルを持つ点で値オブジェクトと異なる。
基本的にプロパティの値は可変だが、不変にできるならその方が可読性は上がる。

## サービス

> ソフトウェア開発の文脈で語られるサービスはクライアントのために何かを行うオブジェクト

### ドメインサービス

値オブジェクトやエンティティに記述すると不自然になってしまう「ふるまい」をドメインサービスに記述して解決する。
複数のドメインオブジェクトを横断するような操作によく見られる。

ドメインサービスに書きすぎてドメインモデル貧血症にならないように注意が必要。

ドメインサービスは値オブジェクトやエンティティと組み合わせて利用される。

ドメインサービスの関心事は値オブジェクトやエンティティと同一の括りであり、本来データストアは存在しない。
入出力を伴う処理を取り扱わないようにするべきという考えもある。

入出力操作はアプリケーションの関心事であり、ドメインの概念や知識のコード上の表現であるドメインオブジェクトがデータストア操作をすることは望ましくない。

#### ドメインサービスの命名

命名規則としては以下３種のどれかになるケースが多い

- ドメインの概念
  - シンプルだがコーディング時に意識が必要になる
- ドメインの概念 + Service
  - e.g. XxxDomain.Services.XxxService
- ドメインの概念 + DomainService
  - 冗長だが勘違い防止には最強

### アプリケーションサービス


