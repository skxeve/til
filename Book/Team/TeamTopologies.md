# チームトポロジー

友人の紹介で読んでみた一冊。最後の14%くらいは参考文献と脚注。2021/12初版の翻訳本。

一般的な単語としてのトポロジーは、幾何学や位相の意味。コンピュータ関連としてはネットワークのノードの接続形態を指すそうだ。
おそらく本書は後者をチーム間の接続形態を示すものとしてチームトポロジーと題している。
Part1は色々と学びが多かったが、Part2とPart3は当たり前のことを当たり前に話しているページが多かったように感じた。

こういう課題に直面する組織が多いということは結局のところ「権限の委譲」が適切にできていない組織が多いのではないだろうかと感じた。
権限を委譲しようと思えば「何の権限を委譲するのか」を考えることになり、自然とチームの役割や目的は定まっていく。
それが大きすぎたりして認知負荷の限界を超えてしまうケースは問題で、それはチームをいかに小さく保つか、ひいてはシステムを小さく保つか、という話にも通じてくる。
大きくなってしまったチームをどうするか、の解決策はあっただろうか・・・

本書の考え方で重要な部分はおそらく「４種類のチーム種別」と「３種類のインタラクション」を明示的に組織で用いることにあり、他の概念や考え方は全てそれを支えるものと捉えて差し支えなさそう。
日本の組織に導入することを考えると「チームファースト思考」の導入が、特に「チーム全体の活動に対してチーム全体に報酬が与えられる」制度導入の難易度が非常に高そう。

## デリバリー手段としてのチーム

チームという概念を要素に分解して定義したり、運用する上での法則に触れている。

> ハイパフォーマンスなチームを解散するのは、単なる破壊行為では済まない。企業レベルのサイコパスと呼ぶべきものだ。

### 認知負荷

- 一般的に、システムの複雑度が増すにつれて、組織を作り進化させていくのに必要な認知は増える。
- 明確な責任と境界を持つチームにすることで認知負荷を低減する。
- チーム同士がいつ、どのようにやりとりするかを理解しておかなければならない。
- チーム同士のやりとりは時間を追うごとに進化する必要がある。
- 認知負荷を考慮しないと、チームの責任範囲と担当領域は広がりすぎることになる。自分の仕事に熟達するだけの余裕がなくなり、担当業務のコンテキストスイッチに悩まされる。
- ダニエル・ピンクが提唱する内発的動機づけの3要素
  1. 自律
    - 複数のチームの要求や優先順位を絶えず調整することで失われる
  2. 熟達
    - 多芸は無芸
  3. 目的
    - 広すぎる責任範囲

### コンウェイの法則と、逆コンウェイ戦略

- 組織の設計するシステムは、その組織のコミュニケーション構造を反映した設計になる、という法則。
- システムのアーキテクチャと組織のアーキテクチャが対立する場合、組織が勝つ
- チーム構造と組織構造を進化させて望ましいシステム設計を実現するのが逆コンウェイ戦略
- デリバリーの基本となる手段はチーム
- ものごとを分離しチーム内にとどめておくことが重要
- チームを編成する前にどんなソフトウェアアーキテクチャが必要化を理解しておく必要があり、技術的専門知識が必要
- ソフトウェアアーキテクチャのグッドプラクティス
  1. 疎結合
  2. 高凝集性
  3. 明確かつ適切なバージョン互換性
  4. 明確かつ適切なチーム横断でのテスト実行
- 落とし穴
  - チームや部門の責任境界とツールの責任の不一致

## チームファースト思考

チームとは5人から9人のメンバーからなる安定したグループで、共有されたゴールのために働く単位のことを示す。
モダンなソフトウェアを開発して進化させるのに必要な情報の質と量を適切にコントロールし続けるのは個人では継続不可能であり、偉業を成し遂げるのに団結したチームは必須だと説いている。

チームの規模を一定に抑えることは重要で、人間の認知限界や信頼関係に大きく関わる。ダンバー数によって駆動される。
変更を素早く届けるには強い信頼関係が明確に価値として認められており、そのために組織が設計されていることが重要とされる。

### チームの形成やメンバーの出入り

チームを作ってから一体となれるまで2週間から3ヶ月以上かかるのが一般的。
ブルックスの法則として知られるように、チームメンバーを追加した初期段階はチームのキャパシティはむしろ減る。
適切なメンバーのチーム間移動のスパンは組織の信頼性によって左右されるが、通常の組織では信頼感がそこまで高くないため、同じチームに長い期間（1.5~2年ほど）とどまるのが適切なケースが多い。

チームの成長を４段階で説明するタックマンモデルがあるが、混乱期はずっと続くという考え方が最近は強いらしい。
1. 形成期：最初にチームが集まる
2. 混乱期：個性やそれぞれの仕事のやり方の差がある中で取り組み始める
3. 統一期：一緒に働く標準的なやり方を進化させる
4. 機能期：高い効果を出せる状態になる

### チームのマインドセットとインセンティブ設計

チームメンバーにはチームファーストのマインドセットが必要であり、同様に組織は個人ではなくチームに報いるようにすることも重要。
エドワード・デミングが挙げたマネジメントにとって重要な14項目に「年次個人評価の廃止」と「目標設定によるマネジメントの廃止」がある。
現代の組織において、個人のパフォーマンスに対して報酬を与えるのは悪い結果を招きやすく、従業員のふるまいに悪影響を与えることも多い。
チームファーストアプローチでは、チーム全体の活動に対してチームに報酬が与えられる。

### チームの責任

- 実行されるサービス、アプリケーション、サブシステムはそれぞれ単一のチームがオーナーシップを持つべき。
- 認知負荷容量を超える責任を課してチームにストレスを与えると、チームはハイパフォーマンスなユニットとして働くことができなくなり、ただの個人の集まりのように振る舞い始める。
- チームの認知負荷を下げることでチームワークに注意を払えるようにする必要がある
- 同時に負荷を継続的に下げていくための余力が必要で、そのために研修・実践・自動化などの有用な手法を活用していくことになる。
- 基本的には、１チームに対して１つのドメインを割り当てる
  - シンプルなドメインを２〜３扱うことは構わない
  - 複雑なドメインを割り当てられたチームに２個目のドメインを割り当ててはいけない

### エコシステム

チームが働くエコシステムの調整

- チームファーストな作業環境
- 会議やメールの削減
- 問い合わせ担当のチームや担当者を用意するなどして、作業中に気が散ることを減らす
- やり方を指示するのではなく、ゴールとアウトカムを伝えるようなマネジメントスタイル
- DevEXプラクティスを利用
  - 良いドキュメント
  - 一貫性の確保
  - 良いUX
- チームが利用するプラットフォームは明示的に認知負荷を減らすよう設計されたものを使う
- リモートファーストのポリシーにおける仮想環境の重要性
  - 仮想環境とはデジタルスペースのこと
    - Wiki
    - 社内ブログ
    - 外部向けブログ
    - 組織のウェブサイト
    - チャットツール
    - 作業追跡システム
  - ツールを揃えるだけでは十分でなく、現実的な面でのチームの合意が必要
    - 働く時間
    - 応答までの時間
    - ビデオ会議
    - コミュニケーションのトーン
  - 大事なのは場所を同じにすることではなく、目的を同じにすること

## チームトポロジーによるチーム形成

チームの種類を４種類に分類している

1. ストリームアイランドチーム
  - 価値のある単一の仕事に沿って働くチーム
  - ストリームとは仕事の継続的な流れのこと
  - チーム単体ですばやく安全に価値を届けられるよう、チームに権限が委譲されている
  - 組織で根幹となるチームタイプであり、他のチームタイプはストリームアイランドチームの負荷を減らすためにある
2. イネイブリングチーム
  - ストリームアイランドチームが欠いている能力を素早く獲得するのを助ける
  - 特定のテクニカルドメインのスペシャリストから構成され、能力ギャップを埋めるのを助ける
    - 能力獲得と進化を自分でやる場合に必要な労力がチームに与える影響は、10~15倍は過小評価されている
  - テクニカルコンサルティングチームとも呼ばれる
3. コンプリケイテッド・サブシステムチーム
  - 複雑なサブシステムを含んだり利用するストリームアイランドチームの認知負荷を減らす
  - システムの中でスペシャリストの知識が必要となるパーツを開発・保守する責任を持つ
    - 動画処理コーデック、数理モデル、顔認識エンジンなど
4. プラットフォームチーム
  - 下位の詳細な知識を引き取ることでストリームアイランドチームの認知負荷を減らす
  - 少数のサービスを高い品質で提供することに集中するのが現実的

## フローの最大化

チームの認知的限界を考慮しつつフローを最大化するには、コンウェイの法則とチームファーストの２アイデアをどう組み合わせれば良いかを説いている。
そもそもDevOpsとはの歴史的な話やDevOpsトポロジーについてを中心に触れている。
組織内の役割についての曖昧さを減らすことは、モダンな組織設計で成功するための主要な要因である。
全体的にDevとOpsの関係に触れている話が多かったが、それだけその課題を抱える組織が多いということなのだと思う。
解決策は結局はケースバイケースとしか言えない話。

デリバリ担当チームが職能上の枠に縛られず、同一のチーム内でシステムの設計・開発・テスト・デプロイ・運用を行うのに必要なスキルを全て兼ね備えていなければならない。
時間と共に技術的負債が増えると、デリバリーの速度が落ちるにつれてチーム間の信頼が壊れていく。
大きなチームより、スキルの高い人からなる小さなチームの方が、本番環境での方針変更を素早くできる。

SREチームに求められるのは優れたコーディングスキルと、繰り返し行う運用タスクを自動化しトイルを減らし続ける強い意欲と時間的余裕。
ただSREチームの存在は必須ではなくオプションであると言える。

## チーム間のインタラクション

チームインタラクションモードには３種類ある

1. コラボレーション
    - 他のチームと密接に協力して作業すること
    - チーム間で広く責任を共有する
    - 継続的にコラボレーションが必要になる場合、ドメインの境界やチームの責任が正しく無いか、チーム内のスキルが正しく無いことを示している
2. X-as-a-Service
    - 最小限のコラボレーションで何かを利用または提供すること
    - 責任境界が明確
3. ファシリテーション
    - 障害を取り除くために他のチームを支援したり、支援を受けたりすること
    - イネイブリングチームが主に活用する

多くの組織では、チームのインタラクションと責任の不明瞭な定義が軋轢や非効率の原因となっている。
インタラクションモードを選ぶことで目的の明確化、エンゲージメントの向上、他のチームに対するフラストレーションの減少といったメリットを得られる。

## チームトポロジーだけでは不十分であることに留意する

基礎としてのエンジニアリングプラクティスは前提であり、軽視してはならない。

- 健全な組織文化
  - 個人やチームのレベルでプロフェッショナルとしての成長を促す環境
- 良いエンジニアリングプラクティス
  - システムのすべてをテストファーストで設計及び開発する
  - CI/CDと運用プラクティスへのフォーカス
  - ペアワークやモブワークでのコードレビュー
  - 単一の「根本原因」を探そうとしない
  - テストが容易なように設計する
- 健全な投資・財務プラクティス
  - IT組織を設備投資と運用投資で分断するような悪習を避ける
  - プロジェクト指向の納期設定や予算割り当てを避ける
  - 個人ではなくチームやグループにトレーニング予算を割り当てる
- ビジネスビジョンの明確化
  - 役員や経営層が明確で矛盾のないビジョンを提示する

## Tips

- ボーイスカウトルール
    - 自分が来た時よりコードをきれいにして帰る、というのは初耳だったが、良い考え方だと思った。
- 他人の認知負荷を最小にする
    - 良いソフトウェア開発で最もよく使われる経験則の１つ。

## 推奨書籍

日本語化されてそうなものだけピックアップ

- 「LeanとDevOpsの科学［Accelerate］テクノロジーの戦略的活用が組織変革を加速する」2018
- 「Fearless Change アジャイルに効くアイデアを組織に広めるための48のパターン」2014
- 「継続的デリバリー 信頼できるソフトウェアリリースのためのビルド・テスト・デプロイメントの自動化」2017
- 「強いチームはオフィスを捨てる」2013
